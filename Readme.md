# Исследование данных интернет-магазина и формирование персонализированных предложений  
### Постановка задачи
Интернет-магазин продаёт разные товары. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться.        
1. Нужно построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.    
2. В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.    
3. Используя данные модели и данные о прибыльности клиентов, нужно выделить сегменты покупателей и разработать для них персонализированные предложения.    
### Коротко о данных   
В основных данных есть информация о покупателях, среднемесячной прибыли, выручки за 3 месяца, времени, проведенном покупателями на сайте.  
Информация представлена в 4 датафреймах.  
Исходные данные не содержат пропусков.  
Был удален 1 экземпляр аномальных данных из всех таблиц. Также были удалены 3 покупателя, которые не имели покупок во все 3 месяца. После предобработки данные представлены 1296 покупателями. 7 признаков из 16 имеют высокую (0.7-0.9) и заметную (0.5-0.7) корреляцию с целевым признаком - покупательской активностью. Эти признаки были отобраны SelectKBest для построения модели.  
### Используемая метрика
В качестве метрики для задачи была выбрана ROC_AUC, с помощью которой можно оценить качество работы модели вне зависимости от выбранного порога вероятности. Метрику ROC_AUC можно использовать, когда объектов с одним значением целевого признака больше, чем с другим, как в нашей задаче.
### Применяемые модели и методы
•	В работе использовался пайплайн. Рассматривались 4 вида моделей: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и SVC(). Для каждой из них осуществлялся перебор гиперпараметров. В результате случайного поиска с использованием кросс-валидации RandomSearchCV была найдена оптимальная модель LogisticRegression(C=0.8, penalty='l1', random_state=42, solver='saga') с лучшим скейлером MinMaxScaler. Метрика лучшей модели при кросс-валидации: 0.8985. Метрика ROC-AUC на тестовой выборке: 0.9189. Далее был произведен отбор признаков с помощью SelectKBest с использованием статистического теста f_classif. SelectKBest отобрал следующие 7 признаков: среднее значение маркетинговых коммуникаций за последние 6 месяцев, среднемесячная доля акционных покупок за последние 6 месяцев, средний просмотр категорий за визит в течение последнего месяца, среднее количество просмотренных страниц за визит, сумма выручки за препредыдущий_месяц, количество минут на сайте за предыдущий месяц, количество минут на сайте за текущий_месяц. Лучшее значение метрики на тестовых данных roc_auc = 0.9217 получено на 7 признаках.   
•	Анализ важности признаков был осуществлен с помощью shap-визуализации.   
### Результат  
Используя результаты моделирования, клиенты были проранжированы по вероятности снижения покупательской активности.  
Для анализа был выбран сегмент с высокой долей акционных покупок и с высокой вероятностью снижения покупательской активности.   
Были проанализированы факторы, которые влияют на рассматриваемый сегмент более всего, и даны рекомендации для бизнеса.   
Подробное описание результата смотрите в работе.   
